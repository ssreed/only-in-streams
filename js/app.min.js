"use strict";!function(e){function t(e){e.preventDefault();var t=d.TWITCH_URL+"?limit="+d.LIMIT+"&q="+p.value+"&callback=handleResponse&client_id="+d.TWITCH_KEY;""!==p.value?o(t):console.warn("Please enter a valid term")}function r(e){e.preventDefault();var t=e.target.parentNode.getAttribute("href");d.CURRENT_PAGE<d.TOTAL_PAGES&&o(t)}function n(e){e.preventDefault();var t=e.target.parentNode.getAttribute("href");o(t)}function i(e){var t=[],r={};c(),u(),e&&e._total>0?(console.info("total: ",e._total),console.info("response: ",e),r={total_results:e._total,next_link:e._links.next,prev_link:e._links.prev,self_link:e._links.self},e.streams.forEach(function(e){t.push({name:e.game,channel_name:e.channel.display_name,number_of_viewers:e.viewers,description:e.channel.status,stream_preview:e.preview.medium,stream_url:e.channel.url,stream_preview_small:e.preview.small,stream_preview_medium:e.preview.medium,stream_preview_large:e.preview.large})}),console.log("streams length: ",t.length)):(m(),t.push({error:"No results available"})),(!t[0].error||t[0].error.length<=0)&&s(r),l(t)}function a(){var e=document.createElement("li");return e.setAttribute("class","stream"),v.appendChild(e),e}function l(e){var t,r="";e[0].error?(t=a(),t.innerHTML=e[0].error,E.querySelector("span").setAttribute("hidden",!0),A.querySelector("span").setAttribute("hidden",!0)):e.forEach(function(e){t=a(),r="<div class='stream-image-container'><a href='"+e.stream_url+"'><img src='"+e.stream_preview+"'srcset='"+e.stream_preview_large+" 640w, "+e.stream_preview_medium+" 320w, "+e.stream_preview_small+" 80w'></a></div><div class='stream-info-container'><a href='"+e.stream_url+"'><div class='name'>"+e.channel_name+"</div></a><div class='game'>"+e.name+" - "+e.number_of_viewers+" viewers</div><div class='description'>"+e.description+"</div></div>",t.innerHTML=r})}function s(e){d.TOTAL_RESULTS=e.total_results,d.CURRENT_PAGE=e.next_link.split("offset=")[1].split("&")[0]/d.LIMIT,d.TOTAL_PAGES=Math.ceil(d.TOTAL_RESULTS/d.LIMIT),L.textContent="Total results: "+e.total_results,g.textContent=d.CURRENT_PAGE+"/"+d.TOTAL_PAGES,E.setAttribute("href",e.next_link+"&callback=handleResponse&client_id="+d.TWITCH_KEY),A.setAttribute("href",e.prev_link?e.prev_link+"&callback=handleResponse&client_id="+d.TWITCH_KEY:""),E.querySelector("span").removeAttribute("hidden"),A.querySelector("span").removeAttribute("hidden")}function o(e){var t=document.createElement("script");t.setAttribute("src",e),T.appendChild(t)}function c(){for(;T.firstChild;)T.removeChild(T.firstChild)}function u(){v.innerHTML.length>0&&(v.innerHTML="")}function m(){g.innerHTML.length>0&&(g.innerHTML=""),L.innerHTML.length>0&&(L.innerHTML="")}console.log("%c app ready ","color: blue; font-size: 20px; background: blueviolet; color: white; text-transform: uppercase");var d={TWITCH_KEY:"2ml2xnkbukvgtn1nr6fgcrscaip5ff8",TWITCH_URL:"https://api.twitch.tv/kraken/search/streams",LIMIT:10,PAGE:1,TOTAL_RESULTS:0,TOTAL_PAGES:1,CURRENT_PAGE:1},_=document.querySelector("#streamsForm"),p=document.querySelector("#searchTerm"),v=document.querySelector(".streams"),T=document.querySelector("#scriptContainer"),f=document.querySelector("#pageRight"),h=document.querySelector("#pageLeft"),g=document.querySelector(".page-numbers"),L=document.querySelector(".total-viewers"),E=document.querySelector("#pageRight"),A=document.querySelector("#pageLeft");_.addEventListener("submit",t),f.addEventListener("click",r),h.addEventListener("click",n),e.handleResponse=i}(window);
